# Автономне відстеження траєкторії: Посібник для початківців
## Не дивіться на бампер, дивіться на дорогу

---

## **Проблема: Людина проти Робота**

Коли ви ведете машину, ви не дивитесь на смугу прямо перед бампером.
Якби ви це робили, ви б їхали зигзагами як божевільний.
**Ви дивитесь вперед.** Ви бачите поворот і починаєте повертати **до того**, як в'їдете в нього.

**Роботи дурні.**
- Простий PID-регулятор дивиться на помилку *прямо зараз*.
- "Я на 1 метр ліворуч, повертай праворуч!"
- Поки він поверне, він вже на 1 метр праворуч. **Коливання.**

Щоб їхати швидко і плавно, треба навчити робота **Передбачати Майбутнє**.

---

## **Рішення**

### **1. Регулятор Stanley (Геометричний)**
Це алгоритм, який виграв **DARPA Grand Challenge** (перші великі автономні перегони).
Він використовує геометрію, а не тільки помилку.
- **Поперечна помилка (Cross Track Error - e):** Відстань від центральної лінії.
- **Помилка курсу (Heading Error - psi):** Чи дивимось ми в правильний бік?
- **Корекція швидкості:** Зі зростанням швидкості посилення ефективно падає, щоб запобігти тремтінню.

> **Аналогія:** "Якщо я близько до лінії, але дивлюсь вбік, ПОВЕРТАЙ РІЗКО. Якщо я далеко, але дивлюсь на неї, ПОВЕРТАЙ ПЛАВНО."

### **2. Предиктивне керування (MPC)**
Підхід "Шахового Гросмейстера".
- **Stanley** реагує на поточний стан.
- **MPC** симулює 50 можливих варіантів майбутнього.
    1.  Що, якщо я поверну на 5 градусів?
    2.  Що, якщо я поверну на 10 градусів?
    3.  Що, якщо я поверну на -5 градусів?
- Він проектує позицію авто на 2 секунди вперед для кожного припущення.
- Він обирає шлях, який:
    - Тримається близько до лінії.
    - Не смикає кермо (Комфорт).
    - Не перевищує фізичних меж (Фізика).

---

## **Як працює симулятор**

### **Траса**
Випадково згенерований сплайн. Можна безпечно перезавантажити (`Оновити сторінку`), якщо траса виглядає божевільною.

### **Контролери**
- **Stanley (Синій):**
    - Дивіться, як він поводиться на прямих. Надійно.
    - Спостерігайте за поворотами. Може зрізати кут або виїжджати широко залежно від налаштувань.
- **MPC (Червоний):**
    - Дивіться на **Зелені Лінії**. Це його "думки". Він думає, куди їхати.
    - Помітьте, як він повертає **до** початку повороту. Це **Передбачення**.

---

## **Ключові моменти для інтерв'ю**

| Поняття | Пояснення |
|---|---|
| **Lookahead (Горизонт передбачення)** | Відстань, яку контролер "бачить" попереду. Короткий = Нервовий. Довгий = Лінивий/Зрізає кути. |
| **Кінематична модель** | "Модель Велосипеда". Ми математично вдаємо, що у авто 2 колеса (переднє/заднє), щоб спростити математику. |
| **Оптимальне керування** | MPC знаходить математично ідеальний шлях з урахуванням обмежень (як "Не вилетіти з траси"). |
| **Stanley** | Робастний, нелінійний закон зворотного зв'язку. Чудове керування для звичайної їзди. |

> **Реальний світ:** Tesla, Waymo та Uber - ВСІ використовують варіації MPC для планування траєкторії. Це промисловий стандарт.
